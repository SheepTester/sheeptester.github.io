{
  "version": 3,
  "sources": ["../src/handle-error.ts", "../src/utils.ts", "../src/inputs.ts", "../src/output.ts", "../src/source.ts", "../index.ts"],
  "sourcesContent": ["let errors = 0\nlet errorCount: HTMLElement | undefined\nlet errorLog: HTMLElement | undefined\n\nfunction handleError (error: string) {\n  if (!errorLog || !errorCount) {\n    errorCount = Object.assign(document.createElement('a'), {\n      className: 'error-count',\n      href: '#errors'\n    })\n    const errorCountWrapper = Object.assign(document.createElement('h2'), {\n      className: 'error-count-wrapper'\n    })\n    errorCountWrapper.append(errorCount)\n    const note = Object.assign(document.createElement('p'), {\n      className: 'error-note',\n      textContent:\n        \"It could be due to a bug, or your input is not the correct format. If you'd like to report the error, please send me the entire error log below.\"\n    })\n    errorLog = Object.assign(document.createElement('pre'), {\n      className: 'error-log'\n    })\n    const wrapper = Object.assign(document.createElement('div'), {\n      className: 'error-wrapper',\n      id: 'errors'\n    })\n    wrapper.append(note, errorLog)\n    document.body.append(errorCountWrapper, wrapper)\n  }\n  errorLog.append(error, '\\n')\n  errors++\n  errorCount.textContent = `${errors} error${errors === 1 ? '' : 's'} occurred`\n}\n\nwindow.onerror = (message, source, line, col, error) => {\n  handleError(\n    // Firefox does not include name/message in error, but Chrome does\n    error?.stack && error.stack.includes(error.name)\n      ? `Uncaught ${error.stack}`\n      : `Uncaught ${\n        error?.name ?? String(error)\n      }: ${message} at ${source}:${line}${col !== undefined ? ':' + col : ''}${\n        error?.stack ? '\\n\\t' + error.stack.replaceAll('\\n', '\\n\\t') : ''\n      }`\n  )\n}\n\nwindow.addEventListener('unhandledrejection', ({ reason: error }) => {\n  handleError(\n    error?.stack && error.stack.includes(error.name)\n      ? `Uncaught (in promise) ${error.stack}`\n      : error instanceof Error\n        ? `Uncaught (in promise) ${error.constructor.name}: ${error.message}${\n          error?.stack ? '\\n\\t' + error.stack.replaceAll('\\n', '\\n\\t') : ''\n        }`\n        : String(error)\n  )\n})\n", "/** Milliseconds to show the done icon for after copying */\nexport const DONE_TIMEOUT = 1000\n\n/**\n * Based on\n * https://github.com/SheepTester/hello-world/blob/master/questionable-host/gdrive/upload-videos.ts#L17\n *\n * Note: assumes `bytes` is under a terabyte (currently shows 1 TB = 1.00e+3\n * GB).\n */\nexport function displayBytes (bytes: number): string {\n  if (bytes > 1_000_000_000) {\n    return `${(bytes / 1_000_000_000).toPrecision(3)} GB`\n  } else if (bytes > 1_000_000) {\n    return `${(bytes / 1_000_000).toPrecision(3)} MB`\n  } else if (bytes > 1_000) {\n    return `${(bytes / 1_000).toPrecision(3)} kB`\n  } else if (bytes !== 1) {\n    return `${bytes} bytes`\n  } else {\n    return '1 byte'\n  }\n}\n\n/**\n * Removes the extension of the given file name:\n * - `hello.min.js` -> `hello.min`\n * - `hey` -> `hey`\n */\nexport function fileName (name: string): string {\n  const index = name.lastIndexOf('.')\n  return index === -1 ? name : name.slice(0, index)\n}\n", "import { Source } from './source'\nimport { displayBytes, DONE_TIMEOUT, fileName } from './utils'\n\nconst encoder = new TextEncoder()\n\nfunction selectItem<T extends { type: string }> (\n  items: T[],\n  preferredTypes: string[]\n): T {\n  return (\n    items.find(({ type }) =>\n      preferredTypes.some(prefix => type.startsWith(prefix))\n    ) ?? items[0]\n  )\n}\nfunction getDataTransfer (\n  item: DataTransferItem\n): Promise<string | File | null> {\n  return item.kind === 'string'\n    ? new Promise<string>(resolve => item.getAsString(resolve))\n    : Promise.resolve(item.getAsFile())\n}\n\ntype FileInputOptions = {\n  fileName: Element | null\n  input: HTMLInputElement\n  dropTarget: HTMLElement | null\n  pasteTarget: boolean\n  pasteButton: HTMLButtonElement | null\n  defaultPreferredTypes: string[]\n  /** Returns whether the file was accepted. */\n  onFile: (file: File | string) => Promise<boolean | void>\n}\nfunction handleFileInput ({\n  fileName,\n  input,\n  dropTarget,\n  pasteTarget,\n  pasteButton,\n  defaultPreferredTypes,\n  onFile\n}: FileInputOptions): void {\n  const preferredTypes = input.accept\n    ? input.accept.replaceAll('*', '').split(',')\n    : defaultPreferredTypes\n\n  // Lists must be nonempty\n  type FileToHandle =\n    | { type: 'files'; files: ArrayLike<File> }\n    | { type: 'data-transfer'; transfer: DataTransfer }\n    | { type: 'clipboard'; items: { item: ClipboardItem; type: string }[] }\n  async function handleFile (data: FileToHandle): Promise<void> {\n    let file\n    switch (data.type) {\n      case 'files': {\n        file = selectItem(Array.from(data.files), preferredTypes)\n        break\n      }\n      case 'data-transfer': {\n        file = await getDataTransfer(\n          selectItem(Array.from(data.transfer.items), preferredTypes)\n        )\n        break\n      }\n      case 'clipboard': {\n        const { item, type } = selectItem(data.items, preferredTypes)\n        const blob = await item.getType(type)\n        file = new File([blob], type.replaceAll('/', '_'), {\n          type: blob.type\n        })\n        break\n      }\n    }\n    if (file === null) {\n      return\n    }\n    const fileNameContent =\n      file instanceof File\n        ? `${file.name} \u00B7 ${displayBytes(file.size)}`\n        : `Plain text \u00B7 ${displayBytes(encoder.encode(file).length)}`\n    try {\n      const accepted = (await onFile(file)) ?? true\n      if (accepted && fileName) {\n        fileName.textContent = fileNameContent\n        fileName.classList.remove('file-error')\n      }\n    } catch (error) {\n      if (fileName) {\n        fileName.textContent = fileNameContent + ' \u2014 failed to load'\n        fileName.classList.add('file-error')\n      }\n      throw error\n    }\n  }\n\n  input.addEventListener('change', () => {\n    if (input.files && input.files.length > 0) {\n      handleFile({ type: 'files', files: input.files })\n    }\n    // Reset files array (so can resubmit the same file multiple times)\n    input.value = ''\n  })\n  if (input.dataset.default) {\n    const url = input.dataset.default\n    const name = url.slice(url.lastIndexOf('/') + 1)\n    fetch(url)\n      .then(r => r.blob())\n      .catch(error => {\n        if (fileName) {\n          fileName.textContent = name + ' \u2014 failed to load'\n          fileName.classList.add('file-error')\n        }\n        throw error\n      })\n      .then(blob =>\n        handleFile({ type: 'files', files: [new File([blob], name, blob)] })\n      )\n  }\n\n  dropTarget?.addEventListener('drop', e => {\n    if (e.dataTransfer && e.dataTransfer.items.length > 0) {\n      handleFile({ type: 'data-transfer', transfer: e.dataTransfer })\n    }\n    dropTarget.classList.remove('drag-over')\n    e.preventDefault()\n  })\n  dropTarget?.addEventListener('dragover', e => {\n    dropTarget.classList.add('drag-over')\n    e.preventDefault()\n  })\n  dropTarget?.addEventListener('dragleave', () => {\n    dropTarget.classList.remove('drag-over')\n  })\n\n  if (pasteTarget) {\n    document.addEventListener('paste', e => {\n      if (\n        (e.target instanceof HTMLTextAreaElement ||\n          e.target instanceof HTMLInputElement) &&\n        !e.target.readOnly &&\n        !e.target.disabled\n      ) {\n        return\n      }\n      if (e.clipboardData && e.clipboardData.items.length > 0) {\n        handleFile({ type: 'data-transfer', transfer: e.clipboardData })\n      }\n    })\n  }\n\n  let pasteButtonTimeoutId: ReturnType<typeof setTimeout> | null = null\n  pasteButton?.addEventListener('click', async () => {\n    try {\n      pasteButton.disabled = true\n      const items = await navigator.clipboard.read()\n      const itemsByType = items.flatMap(item =>\n        item.types.map(type => ({ item, type }))\n      )\n      if (itemsByType.length > 0) {\n        handleFile({ type: 'clipboard', items: itemsByType })\n      }\n\n      if (pasteButtonTimeoutId) {\n        clearTimeout(pasteButtonTimeoutId)\n      }\n      pasteButton.classList.add('icon-done')\n      pasteButtonTimeoutId = setTimeout(() => {\n        pasteButton.classList.remove('icon-done')\n      }, DONE_TIMEOUT)\n    } catch (error) {\n      if (error instanceof DOMException && error.name === 'NotAllowedError') {\n        // Firefox throws this when the user cancels clicking on \"Paste\"\n        console.warn('Failed to read clipboard', error)\n      } else {\n        throw error\n      }\n    } finally {\n      pasteButton.disabled = false\n    }\n  })\n}\n\nexport function handleSingleFileInput (\n  source: Source<File>,\n  input: HTMLInputElement\n): void {\n  input.dataset.ignore = 'true'\n  const dropTarget = input.closest('.reform\\\\:io')\n  const pasteButton = migrateInputControls(dropTarget)\n  handleFileInput({\n    fileName: input.parentElement?.querySelector('.file-name') ?? null,\n    input,\n    dropTarget: dropTarget instanceof HTMLElement ? dropTarget : null,\n    pasteTarget: input.classList.contains('reform:paste-target'),\n    pasteButton,\n    defaultPreferredTypes: [],\n    onFile: async file => {\n      source.handleValue(\n        file instanceof File\n          ? file\n          : new File([file], 'text.txt', { type: 'text/plain' })\n      )\n    }\n  })\n}\n\nexport function handleImageInput (\n  source: Source<CanvasRenderingContext2D>,\n  input: HTMLInputElement\n): void {\n  input.dataset.ignore = 'true'\n  const dropTarget = input.closest('.reform\\\\:io')\n  const pasteButton = migrateInputControls(dropTarget)\n  let maybeCanvas = dropTarget?.querySelector('.input-content canvas')\n  if (maybeCanvas && !(maybeCanvas instanceof HTMLCanvasElement)) {\n    console.warn(maybeCanvas, 'is not a <canvas> element')\n    maybeCanvas = null\n  }\n  const canvas = maybeCanvas ?? document.createElement('canvas')\n  const context = canvas.getContext('2d', {\n    willReadFrequently: !!canvas.dataset.willReadFrequently\n  })\n  if (!context) {\n    throw new TypeError(\n      'Failed to get canvas context for the image input preview.'\n    )\n  }\n  handleFileInput({\n    fileName: input.parentElement?.querySelector('.file-name') ?? null,\n    input,\n    dropTarget: dropTarget instanceof HTMLElement ? dropTarget : null,\n    pasteTarget: input.classList.contains('reform:paste-target') ?? false,\n    pasteButton,\n    defaultPreferredTypes: ['image/*'],\n    onFile: async file => {\n      if (typeof file === 'string') {\n        return false\n      }\n      const url = URL.createObjectURL(file)\n      try {\n        const image = document.createElement('img')\n        image.src = url\n        await new Promise((resolve, reject) => {\n          image.addEventListener('load', resolve)\n          image.addEventListener('error', () =>\n            reject(new TypeError(`Could not load '${file.name}' as image.`))\n          )\n        })\n        canvas.dataset.name = fileName(file.name)\n        canvas.width = image.width\n        canvas.height = image.height\n        context.drawImage(image, 0, 0)\n        source.handleValue(context)\n      } finally {\n        URL.revokeObjectURL(url)\n      }\n    }\n  })\n}\n\nexport function handleVideoInput (\n  source: Source<HTMLVideoElement>,\n  input: HTMLInputElement\n): void {\n  input.dataset.ignore = 'true'\n  const dropTarget = input.closest('.reform\\\\:io')\n  const pasteButton = migrateInputControls(dropTarget)\n  let maybeVideo = dropTarget?.querySelector('.input-content video')\n  if (maybeVideo && !(maybeVideo instanceof HTMLVideoElement)) {\n    console.warn(maybeVideo, 'is not a <video> element')\n    maybeVideo = null\n  }\n  const video = maybeVideo ?? document.createElement('video')\n  let url: string | undefined\n  handleFileInput({\n    fileName: input.parentElement?.querySelector('.file-name') ?? null,\n    input,\n    dropTarget: dropTarget instanceof HTMLElement ? dropTarget : null,\n    pasteTarget: input.classList.contains('reform:paste-target'),\n    pasteButton,\n    defaultPreferredTypes: ['video/*'],\n    onFile: async file => {\n      if (typeof file === 'string') {\n        return false\n      }\n      if (url) {\n        URL.revokeObjectURL(url)\n      }\n      // Do not revoke URL or rest of video won't load\n      url = URL.createObjectURL(file)\n      video.src = url\n      video.dataset.name = fileName(file.name)\n      await new Promise<void>((resolve, reject) => {\n        video.onloadeddata = () => {\n          if (video.readyState < 2) return\n          resolve()\n        }\n        video.onerror = () =>\n          reject(new TypeError(`Could not load '${file.name}' as video.`))\n      })\n      source.handleValue(video)\n    }\n  })\n}\n\nexport function handleTextInput (\n  source: Source<string>,\n  input: HTMLInputElement\n): void {\n  const wrapper = input.closest('.reform\\\\:io')\n  const pasteButton = migrateInputControls(wrapper)\n  input.dataset.ignore = 'true'\n  const dropTarget = wrapper?.querySelector('.input-controls')\n  const textarea = wrapper?.querySelector('.input-content')\n  handleFileInput({\n    fileName: input.parentElement?.querySelector('.file-name') ?? null,\n    input,\n    dropTarget: dropTarget instanceof HTMLElement ? dropTarget : null,\n    pasteTarget: input.classList.contains('reform:paste-target'),\n    pasteButton,\n    defaultPreferredTypes: ['text/plain'],\n    onFile: async file => {\n      const text = file instanceof File ? await file.text() : file\n      if (textarea instanceof HTMLTextAreaElement) {\n        textarea.value = text\n      }\n      source.handleValue(text)\n    }\n  })\n}\n\nfunction migrateInputControls (\n  wrapper: Element | null | undefined\n): HTMLButtonElement | null {\n  let inputControls = wrapper?.querySelector('.input-controls')\n  if (inputControls instanceof HTMLLabelElement) {\n    const newInputControls = document.createElement('div')\n    newInputControls.classList.add('input-controls')\n    inputControls.classList.remove('input-controls')\n    inputControls.replaceWith(newInputControls)\n    newInputControls.append(inputControls)\n    inputControls = newInputControls\n  }\n\n  if (inputControls && !wrapper?.querySelector('.reform\\\\:paste')) {\n    const pasteButton = document.createElement('button')\n    pasteButton.type = 'button'\n    pasteButton.classList.add('icon', 'icon-paste', 'reform:paste')\n    pasteButton.ariaLabel = 'Paste from clipboard'\n    pasteButton.title = 'Paste from clipboard'\n    inputControls.append(pasteButton)\n    return pasteButton\n  }\n\n  return null\n}\n", "import { displayBytes, DONE_TIMEOUT } from './utils'\n\nconst NO_BLOB_ERROR = Symbol('no blob error')\n\ntype OutputElements = {\n  fileName: Element | null\n  downloadLink: HTMLAnchorElement | null\n  copyButton: HTMLButtonElement | null\n  shareButton: HTMLButtonElement | null\n}\nexport class OutputControls {\n  #output: OutputProvider | null = null\n  #blob: Promise<Blob | null> | null = null\n  #clipboardBlob: Promise<Blob | null> | null = null\n  #url: string | null = null\n  #elements: OutputElements\n  #downloadButton: DownloadButton | null = null\n  #downloadButtonMounted = false\n  #copyButtonTimeoutId: ReturnType<typeof setTimeout> | null = null\n  #shareButtonTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  constructor (elements: OutputElements) {\n    this.#elements = elements\n\n    const { copyButton, shareButton } = elements\n\n    if (copyButton) {\n      copyButton.disabled = true\n    }\n    if (shareButton) {\n      shareButton.disabled = true\n    }\n\n    copyButton?.addEventListener('click', async () => {\n      try {\n        copyButton.disabled = true\n        this.#clipboardBlob ??= this.#getBlob(true)\n        const clipboardTypeHint =\n          this.#output?.clipboardTypeHint ??\n          this.#output?.downloadTypeHint ??\n          (this.#output?.value\n            ? this.#output.value instanceof CanvasRenderingContext2D\n              ? 'image/png'\n              : this.#output.value.type\n            : null)\n        if (!clipboardTypeHint) {\n          throw new TypeError(\n            'Unable to determine MIME type of clipboard blob. Did you set `clipboardTypeHint`?'\n          )\n        }\n        try {\n          await navigator.clipboard.write([\n            new ClipboardItem({\n              [clipboardTypeHint]: this.#clipboardBlob.then(blob =>\n                blob ? blob : Promise.reject(NO_BLOB_ERROR)\n              )\n            })\n          ])\n        } catch (error) {\n          if (error === NO_BLOB_ERROR) {\n            return\n          } else {\n            throw error\n          }\n        }\n        if (this.#copyButtonTimeoutId) {\n          clearTimeout(this.#copyButtonTimeoutId)\n        }\n        copyButton.classList.add('icon-done')\n        this.#copyButtonTimeoutId = setTimeout(() => {\n          copyButton.classList.remove('icon-done')\n        }, DONE_TIMEOUT)\n      } finally {\n        copyButton.disabled = false\n      }\n    })\n\n    shareButton?.addEventListener('click', async () => {\n      try {\n        shareButton.disabled = true\n        this.#blob ??= this.#getBlob()\n        const blob = await this.#blob\n        if (!blob) {\n          return\n        }\n        await navigator.share({\n          files: [\n            new File([blob], this.#output?.fileName ?? '', {\n              type: blob.type\n            })\n          ]\n        })\n        if (this.#shareButtonTimeoutId) {\n          clearTimeout(this.#shareButtonTimeoutId)\n        }\n        shareButton.classList.add('icon-done')\n        this.#shareButtonTimeoutId = setTimeout(() => {\n          shareButton.classList.remove('icon-done')\n        }, DONE_TIMEOUT)\n      } catch (error) {\n        if (error instanceof DOMException && error.name === 'AbortError') {\n          console.warn('Share cancelled', error)\n        } else {\n          throw error\n        }\n      } finally {\n        shareButton.disabled = false\n      }\n    })\n\n    if (!('share' in navigator)) {\n      shareButton?.remove()\n    }\n  }\n\n  /**\n   * Do not call more than once per `OutputProvider`. Please use this pattern:\n   *\n   * ```ts\n   * this.#blob ??= this.#getBlob()\n   * const blob = await this.#blob\n   * ```\n   */\n  async #getBlob (clipboard = false): Promise<Blob | null> {\n    if (clipboard) {\n      if (this.#output?.provideClipboard) {\n        return this.#output.provideClipboard()\n      }\n      // Avoid re-running provideDownload\n      this.#blob ??= this.#getBlob()\n      return this.#blob\n    }\n    if (!this.#output) {\n      return null\n    }\n    if (this.#output.value instanceof Blob) {\n      return this.#output.value\n    }\n    if (this.#output.value instanceof CanvasRenderingContext2D) {\n      const { canvas } = this.#output.value\n      return new Promise((resolve, reject) => {\n        canvas.toBlob(blob => {\n          if (!blob) {\n            reject(new Error('canvas.toBlob returned null'))\n            return\n          }\n          if (this.#output) {\n            this.#setFileNameFromBlob(blob)\n          }\n          resolve(blob)\n        })\n      })\n    }\n    if (!this.#output.provideDownload) {\n      return null\n    }\n    const blob = await this.#output.provideDownload()\n    this.#setFileNameFromBlob(blob)\n    return blob\n  }\n\n  #setFileNameFromBlob (blob: Blob | null) {\n    const fileNameElem = this.#downloadButtonMounted\n      ? this.#downloadButton?.fileName\n      : this.#elements.fileName\n    if (this.#output && fileNameElem) {\n      let downloadText = this.#output.fileName ?? ''\n      if (blob) {\n        if (downloadText) {\n          downloadText += ' \u00B7 '\n        }\n        downloadText += displayBytes(blob.size)\n      }\n      fileNameElem.textContent = downloadText\n    }\n  }\n\n  handleOutput (output: File | OutputProvider): void {\n    this.#output =\n      output instanceof File ? OutputProvider.from(output.name, output) : output\n    this.#blob = null\n    this.#clipboardBlob = null\n    if (this.#url) {\n      URL.revokeObjectURL(this.#url)\n    }\n    this.#url = null\n\n    const { copyButton, shareButton, downloadLink } = this.#elements\n    if (copyButton) {\n      copyButton.disabled = false\n    }\n    if (shareButton) {\n      shareButton.disabled = false\n    }\n    if (downloadLink) {\n      downloadLink.download = this.#output.fileName ?? ''\n      if (this.#output.value instanceof Blob) {\n        this.#url = URL.createObjectURL(this.#output.value)\n        downloadLink.href = this.#url\n        if (this.#downloadButtonMounted) {\n          this.#downloadButton?.button.replaceWith(downloadLink)\n          this.#downloadButtonMounted = false\n        }\n      } else {\n        this.#downloadButton ??= createDownloadButtonFromLink(\n          downloadLink,\n          async downloadButton => {\n            try {\n              downloadButton.disabled = true\n              if (!this.#url) {\n                this.#blob ??= this.#getBlob()\n                const blob = await this.#blob\n                if (!blob) {\n                  return\n                }\n                this.#url = URL.createObjectURL(blob)\n                downloadLink.href = this.#url\n              }\n              document.body.append(downloadLink)\n              downloadLink.click()\n              downloadLink.remove()\n            } finally {\n              downloadButton.disabled = false\n            }\n          }\n        )\n        if (!this.#downloadButtonMounted) {\n          downloadLink.replaceWith(this.#downloadButton.button)\n          this.#downloadButtonMounted = true\n        }\n      }\n    }\n\n    this.#setFileNameFromBlob(\n      this.#output.value instanceof Blob ? this.#output.value : null\n    )\n  }\n\n  static fromWrapper (wrapper?: Element | null): OutputControls {\n    let downloadLink = wrapper?.querySelector('.download') ?? null\n    if (downloadLink && !(downloadLink instanceof HTMLAnchorElement)) {\n      console.warn(downloadLink, 'download link is not an <a> element')\n      downloadLink = null\n    }\n\n    let copyButton =\n      wrapper?.querySelector('button.icon-copy, .reform\\\\:copy') ?? null\n    if (copyButton && !(copyButton instanceof HTMLButtonElement)) {\n      console.warn(copyButton, 'copy button is not a <button> element')\n      copyButton = null\n    }\n\n    let shareButton = wrapper?.querySelector('button.icon-share') ?? null\n    if (shareButton && !(shareButton instanceof HTMLButtonElement)) {\n      console.warn(shareButton, 'copy button is not a <button> element')\n      shareButton = null\n    }\n\n    return new OutputControls({\n      fileName: wrapper?.querySelector('.file-name') ?? null,\n      downloadLink,\n      copyButton,\n      shareButton\n    })\n  }\n}\n\ntype DownloadButton = {\n  button: HTMLButtonElement\n  fileName: Element | null\n}\nfunction createDownloadButtonFromLink (\n  downloadLink: HTMLAnchorElement,\n  onClick: (button: HTMLButtonElement) => void\n): DownloadButton {\n  const button = document.createElement('button')\n  button.className = downloadLink.className\n  for (const child of downloadLink.childNodes) {\n    button.append(child.cloneNode(true))\n  }\n  button.addEventListener('click', () => onClick(button))\n  return { button, fileName: button.querySelector('.file-name') }\n}\n\nexport abstract class OutputProvider {\n  fileName?: string\n  /**\n   * Canvas contexts are turned into PNG images.\n   */\n  value?: Blob | CanvasRenderingContext2D\n\n  /**\n   * MIME type of download. Ignored if `value` is set. Currently only used as\n   * fallback when `clipboardTypeHint` is omitted, but it is recommended to set\n   * this in case I add blob type feature detection in the future.\n   */\n  downloadTypeHint?: string\n  /** Ignored if `value` is set. */\n  provideDownload? (): PromiseLike<Blob> | Blob\n\n  /**\n   * MIME type of clipboard blob. Preferred over `downloadTypeHint`. Must be\n   * specified if `provideClipboard` is also specified.\n   */\n  clipboardTypeHint?: string\n  /**\n   * If the blob type is not supported by the Clipboard API, then specify this\n   * method for the copy button, which when set will be preferred over `value`\n   * or `provideDownload`.\n   *\n   * Guaranteed to be called at most once.\n   */\n  provideClipboard? (): PromiseLike<Blob> | Blob\n\n  /**\n   * @param type Defaults to `text/plain`\n   */\n  static from (\n    fileName: string,\n    value: CanvasRenderingContext2D | BlobPart,\n    type = 'text/plain'\n  ): OutputProvider {\n    return new FileOutputProvider(\n      fileName,\n      value instanceof Blob || value instanceof CanvasRenderingContext2D\n        ? value\n        : new Blob([value], { type })\n    )\n  }\n}\n\nclass FileOutputProvider extends OutputProvider {\n  constructor (fileName: string, value: Blob | CanvasRenderingContext2D) {\n    super()\n    this.fileName = fileName\n    this.value = value\n  }\n}\n", "export class Source<T> {\n  lastValue?: T\n  dependents: ((value: T) => void)[] = []\n\n  handleValue (value: T): void {\n    // TODO: skip if the value is the same\n    this.lastValue = value\n    for (const dependent of this.dependents) {\n      dependent(value)\n    }\n  }\n}\n", "import './reform.css'\nimport './src/handle-error'\nimport {\n  handleImageInput,\n  handleSingleFileInput,\n  handleTextInput,\n  handleVideoInput\n} from './src/inputs'\nimport { OutputControls, OutputProvider } from './src/output'\nimport { Source } from './src/source'\n\nexport { OutputProvider as Out } from './src/output'\n\nconst sources: Record<string, Source<any>> = {}\n\n/**\n * Determines the source type from the element and sets the value if necessary.\n * Called during initialization and by input/change events.\n */\nfunction handleElement (element: unknown): void {\n  if (element instanceof HTMLElement && element.dataset.ignore) {\n    return\n  }\n  if (element instanceof HTMLInputElement) {\n    sources[element.name] ??= new Source()\n    if (\n      element.type === 'number' ||\n      element.type === 'range' ||\n      element.inputMode === 'numeric'\n    ) {\n      if (element.value === '') {\n        return\n      }\n      // valueAsNumber is not available for type=text\n      // https://stackoverflow.com/a/18062487\n      sources[element.name].handleValue(+element.value)\n      const rangeWrapper = element.closest('.range-wrapper')\n      if (rangeWrapper) {\n        let range = element\n        if (element.type === 'range') {\n          const input = rangeWrapper.lastElementChild\n          if (input instanceof HTMLInputElement) {\n            input.value =\n              element.step === 'any' || (element.step && +element.step < 0.1)\n                ? (+element.value).toFixed(2)\n                : element.value\n          }\n        } else {\n          const rangeInput = rangeWrapper.querySelector('[type=\"range\"]')\n          if (rangeInput instanceof HTMLInputElement) {\n            range = rangeInput\n          } else {\n            return\n          }\n          range.value = element.value\n        }\n        const progress =\n          (+element.value - +range.min) / (+range.max - +range.min)\n        range.style.setProperty('--progress', `${progress * 100}%`)\n      }\n    } else if (element.type === 'checkbox') {\n      sources[element.name].handleValue(element.checked)\n    } else if (element.type === 'file') {\n      if (element.files && element.files.length > 0) {\n        sources[element.name].handleValue(Array.from(element.files))\n      }\n    } else if (element.type === 'radio') {\n      if (element.checked) {\n        sources[element.name].handleValue(element.value)\n      }\n    } else {\n      sources[element.name].handleValue(element.value)\n    }\n  } else if (\n    element instanceof HTMLTextAreaElement ||\n    element instanceof HTMLSelectElement\n  ) {\n    sources[element.name] ??= new Source()\n    sources[element.name].handleValue(element.value)\n  }\n}\n\nfor (const input of document.getElementsByClassName('reform:image-input')) {\n  if (!(input instanceof HTMLInputElement)) {\n    continue\n  }\n  sources[input.name] ??= new Source()\n  handleImageInput(sources[input.name], input)\n}\nfor (const input of document.getElementsByClassName('reform:video-input')) {\n  if (!(input instanceof HTMLInputElement)) {\n    continue\n  }\n  sources[input.name] ??= new Source()\n  handleVideoInput(sources[input.name], input)\n}\nfor (const input of document.getElementsByClassName('reform:text-input')) {\n  if (!(input instanceof HTMLInputElement)) {\n    continue\n  }\n  sources[input.name] ??= new Source()\n  handleTextInput(sources[input.name], input)\n}\nfor (const input of document.getElementsByClassName('reform:file-input')) {\n  if (!(input instanceof HTMLInputElement)) {\n    continue\n  }\n  sources[input.name] ??= new Source()\n  handleSingleFileInput(sources[input.name], input)\n}\n\nfor (const form of document.forms) {\n  for (const element of form.elements) {\n    handleElement(element)\n  }\n}\n\ndocument.addEventListener('input', e => handleElement(e.target))\ndocument.addEventListener('change', e => handleElement(e.target))\n\nexport type SourceSpec =\n  | {\n      name: string\n      deps?: string[]\n    }\n  | string\ntype Dep = {\n  name: string\n  reference: boolean\n}\ntype Object = {\n  name: string\n  element: HTMLElement\n  object: HTMLElement | CanvasRenderingContext2D | null\n  deps: Dep[]\n}\nconst objects: Record<string, Object> = {}\n\nfunction findObjectByName (spec: SourceSpec): Object {\n  const name = typeof spec === 'string' ? spec : spec.name\n  if (!objects[name]) {\n    let element = document.getElementById(name)\n    if (!element) {\n      const elements = document.getElementsByName(name)\n      if (elements.length > 1) {\n        console.warn(\n          'More than one element with name',\n          name,\n          Array.from(elements)\n        )\n      }\n      element = elements[0] ?? null\n    }\n    const object =\n      element instanceof HTMLCanvasElement &&\n      !element.classList.contains('reform:canvas-element')\n        ? element.getContext('2d')\n        : element\n    const deps =\n      (typeof spec !== 'string' && spec.deps) ||\n      element?.dataset.deps?.split(' ') ||\n      []\n    objects[name] = {\n      name,\n      element,\n      object,\n      deps: deps.map(dep =>\n        dep.startsWith('&')\n          ? { name: dep.slice(1), reference: true }\n          : { name: dep, reference: false }\n      )\n    }\n  }\n\n  return objects[name]\n}\n\nexport function on<T> (\n  spec: SourceSpec,\n  callback: (\n    object: HTMLElement | CanvasRenderingContext2D | null,\n    args: Record<string, unknown>\n  ) => Promise<T>\n): void {\n  const { name, element, object, deps } = findObjectByName(spec)\n  sources[name] ??= new Source()\n\n  const args: Record<string, unknown> = {\n    // Call `callback` to return multiple values\n    callback: (value: unknown) => {\n      sources[name].handleValue(value)\n    }\n  }\n\n  if (!element.classList.contains('reform:io-ignore')) {\n    const outputControls = element\n      ?.closest('.reform\\\\:io')\n      ?.querySelector('.output-controls')\n    if (outputControls) {\n      const output = OutputControls.fromWrapper(outputControls)\n      sources[name].dependents.push(file => {\n        if (file instanceof File || file instanceof OutputProvider) {\n          output.handleOutput(file)\n        }\n      })\n    }\n  }\n\n  let lastCallId = 0\n  const compute = async () => {\n    if (ready.size === deps.length) {\n      const callId = ++lastCallId\n      const value = await callback(object, args)\n      if (callId !== lastCallId) {\n        return\n      }\n      if (value !== undefined) {\n        sources[name].handleValue(value)\n      }\n    }\n  }\n\n  const ready = new Set<string>()\n  for (const { name: dep, reference } of deps) {\n    if (reference) {\n      const { object } = findObjectByName(dep)\n      args[dep] = object\n      ready.add(dep)\n    } else {\n      sources[dep] ??= new Source()\n      if (sources[dep].lastValue !== undefined) {\n        args[dep] = sources[dep].lastValue\n        ready.add(dep)\n      }\n      sources[dep].dependents.push(value => {\n        args[dep] = value\n        ready.add(dep)\n        compute()\n      })\n    }\n  }\n  compute()\n}\n"],
  "mappings": "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",
  "names": ["errors", "errorCount", "errorLog", "handleError", "error", "errorCountWrapper", "note", "wrapper", "message", "source", "line", "col", "displayBytes", "bytes", "fileName", "name", "index", "encoder", "selectItem", "items", "preferredTypes", "type", "prefix", "getDataTransfer", "item", "resolve", "handleFileInput", "fileName", "input", "dropTarget", "pasteTarget", "pasteButton", "defaultPreferredTypes", "onFile", "handleFile", "data", "file", "blob", "fileNameContent", "displayBytes", "error", "url", "name", "r", "e", "pasteButtonTimeoutId", "itemsByType", "handleSingleFileInput", "source", "migrateInputControls", "handleImageInput", "maybeCanvas", "canvas", "context", "image", "reject", "handleVideoInput", "maybeVideo", "video", "handleTextInput", "wrapper", "textarea", "text", "inputControls", "newInputControls", "NO_BLOB_ERROR", "OutputControls", "_OutputControls", "#output", "#blob", "#clipboardBlob", "#url", "#elements", "#downloadButton", "#downloadButtonMounted", "#copyButtonTimeoutId", "#shareButtonTimeoutId", "elements", "copyButton", "shareButton", "#getBlob", "clipboardTypeHint", "blob", "error", "clipboard", "canvas", "resolve", "reject", "#setFileNameFromBlob", "fileNameElem", "downloadText", "displayBytes", "output", "OutputProvider", "downloadLink", "createDownloadButtonFromLink", "downloadButton", "wrapper", "onClick", "button", "child", "fileName", "value", "type", "FileOutputProvider", "Source", "value", "dependent", "sources", "handleElement", "element", "Source", "rangeWrapper", "range", "input", "rangeInput", "progress", "handleImageInput", "handleVideoInput", "handleTextInput", "handleSingleFileInput", "form", "objects", "findObjectByName", "spec", "name", "elements", "object", "deps", "dep", "on", "callback", "args", "value", "outputControls", "output", "OutputControls", "file", "OutputProvider", "lastCallId", "compute", "ready", "callId", "reference"]
}
